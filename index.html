
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>quick-flip-flashcards</title>
    <meta name="description" content="Lovable Generated Project" />
    <meta name="author" content="Lovable" />

    <link rel="icon" href="/lovable-uploads/a6607891-28bd-46db-b390-b3ff7f45221c.png" type="image/png">

    <meta property="og:title" content="quick-flip-flashcards" />
    <meta property="og:description" content="Lovable Generated Project" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/lovable-uploads/34a68d57-18c7-4968-bd09-5785867397a1.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="/lovable-uploads/34a68d57-18c7-4968-bd09-5785867397a1.png" />
  </head>

  <body>
    <div id="root"></div>
    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>
    <script>
    // Get a reference to your button using its unique class name
    // We are using document.querySelector because it's a class, not an ID.
    const upgradeButton = document.querySelector('button.button-inline-flex-items-center-justify-center-gap-2-whitespace-nowrap-rounded-md-red-600');

    // Check if the button was found to prevent errors
    if (upgradeButton) {
        // Add a click event listener to the button
        upgradeButton.addEventListener('click', function() {
            // When clicked, open the Stripe Payment Link in a new tab/window
            // REPLACE 'YOUR_STRIPE_PAYMENT_LINK_HERE' with the actual link you got from Stripe
            window.open(https://buy.stripe.com/dRmfZi3P9cT4bnR7JX2Ji00, '_blank');
        });
    } else {
        console.warn("Upgrade button not found in the DOM.");
    }
</script>
</body>
</html><div class="ai-flashcard-generator" style="margin-top: 50px; padding: 20px; background-color: #f9fafb; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); text-align: center;">
    <h2 style="font-family: 'Inter', sans-serif; color: #333; margin-bottom: 20px;">AI Flashcard Generator (Premium)</h2>

    <div id="premiumFeatureLocked" style="font-family: 'Inter', sans-serif; color: #dc2626; font-weight: bold; margin-bottom: 15px; display: none;">
        This feature requires premium access. Please upgrade!
    </div>

    <div id="aiGeneratorContent" style="display: none;">
        <input type="text" id="topicInput" placeholder="Enter topic (e.g., Photosynthesis, French Revolution)"
               style="width: calc(100% - 20px); max-width: 500px; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 5px; font-size: 1em;">

        <button id="generateFlashcardsBtn"
                style="padding: 12px 25px; background-color: #4f46e5; color: white; border: none; border-radius: 8px; font-size: 1.1em; cursor: pointer; transition: background-color 0.3s ease;">
            Generate Flashcards
        </button>

        <div id="loadingIndicator" style="font-family: 'Inter', sans-serif; margin-top: 15px; color: #666; display: none;">Generating...</div>

        <div id="flashcardOutput" style="margin-top: 30px; text-align: left; background-color: white; padding: 20px; border-radius: 8px; border: 1px solid #eee; min-height: 100px; max-height: 400px; overflow-y: auto; white-space: pre-wrap; font-family: 'Inter', sans-serif; color: #333; font-size: 0.95em; line-height: 1.6;">
            </div>
    </div>
</div><script>
    // --- IMPORTANT: Replace with the URL of your DEPLOYED backend server ---
    // For local testing, use 'http://localhost:3000'
    // Once deployed, this will be something like 'https://your-backend-app.render.com'
    const BACKEND_BASE_URL = 'http://localhost:3000'; // <--- CHANGE THIS TO YOUR DEPLOYED BACKEND URL!
    const BACKEND_AI_ENDPOINT = `${BACKEND_BASE_URL}/generate-flashcards-ai`;

    const topicInput = document.getElementById('topicInput');
    const generateFlashcardsBtn = document.getElementById('generateFlashcardsBtn');
    const flashcardOutput = document.getElementById('flashcardOutput');
    const loadingIndicator = document.getElementById('loadingIndicator');
    const premiumFeatureLocked = document.getElementById('premiumFeatureLocked');
    const aiGeneratorContent = document.getElementById('aiGeneratorContent');

    // --- Client-Side Premium Check (PLACEHOLDER - Needs to be driven by backend) ---
    // This variable should ultimately be set based on a secure response from your backend
    // after a user logs in and their premium status is verified.
    let isUserPremium = false; // Default to false

    // For testing the AI feature (without full backend premium logic):
    // You can temporarily set this to `true` in your browser's console:
    // `isUserPremium = true; toggleAIFeatureVisibility();`
    // Or, uncomment the line below for quick testing:
    // isUserPremium = true; // TEMPORARY: Set to true for local AI feature testing

    function checkPremiumStatusFrontend() {
        // In a real app, this would be updated by your backend after login/subscription check
        return isUserPremium;
    }

    function toggleAIFeatureVisibility() {
        if (checkPremiumStatusFrontend()) {
            premiumFeatureLocked.style.display = 'none';
            aiGeneratorContent.style.display = 'block';
        } else {
            premiumFeatureLocked.style.display = 'block';
            aiGeneratorContent.style.display = 'none';
        }
    }

    // Call on page load to set initial visibility based on premium status
    document.addEventListener('DOMContentLoaded', toggleAIFeatureVisibility);

    // Event listener for the generate button
    generateFlashcardsBtn.addEventListener('click', async () => {
        // Frontend check (can be bypassed, real check is on backend)
        if (!checkPremiumStatusFrontend()) {
            alert('This feature is for premium users only. Please upgrade!');
            return;
        }

        const topic = topicInput.value.trim();
        if (!topic) {
            flashcardOutput.textContent = "Please enter a topic!";
            return;
        }

        loadingIndicator.style.display = 'block';
        flashcardOutput.textContent = ''; // Clear previous output

        try {
            // --- Make the API call to YOUR backend server ---
            const response = await fetch(BACKEND_AI_ENDPOINT, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    // If you implement user authentication, you'd send a token here:
                    // 'Authorization': `Bearer ${userAuthToken}`
                },
                body: JSON.stringify({ topic: topic }), // Send the topic to your backend
            });

            if (!response.ok) {
                const errorData = await response.json();
                let errorMessage = errorData.error || response.statusText;
                if (response.status === 403) {
                    errorMessage = "Access Denied: This feature is for premium users.";
                }
                throw new Error(`Error from backend: ${errorMessage}`);
            }

            const data = await response.json();
            const generatedText = data.flashcards; // Access the 'flashcards' property from your backend response

            if (generatedText) {
                flashcardOutput.textContent = generatedText;
            } else {
                flashcardOutput.textContent = "AI could not generate content. Please try a different topic or be more specific.";
                console.warn("AI response missing expected content:", data);
            }

        } catch (error) {
            console.error('Error calling backend for flashcards:', error);
            flashcardOutput.textContent = 'Failed to generate flashcards. Please try again. (Error: ' + error.message + ')';
        } finally {
            loadingIndicator.style.display = 'none';
        }
    });

    // --- OPTIONAL: Link premium status to your upgrade button for TESTING ONLY ---
    // This allows you to click your existing upgrade button to "enable" AI for testing.
    // In a real app, premium status would be set securely by your backend after a payment.
    const newUpgradeButton = document.getElementById('new-upgrade-button');
    if (newUpgradeButton) {
        newUpgradeButton.addEventListener('click', (event) => {
            // event.preventDefault(); // Uncomment if you want to prevent actual Stripe redirect for testing
            console.log("Upgrade button clicked - simulating premium status for AI feature.");
            isUserPremium = true; // Temporarily set premium status to true
            toggleAIFeatureVisibility(); // Update AI feature visibility
        });
    }

    // You could also add a temporary test button to toggle premium status for quick debugging
    // let tempPremiumToggleButton = document.createElement('button');
    // tempPremiumToggleButton.textContent = 'Toggle Premium (TEST)';
    // tempPremiumToggleButton.style.cssText = 'margin-top: 20px; padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;';
    // tempPremiumToggleButton.addEventListener('click', () => {
    //     isUserPremium = !isUserPremium;
    //     toggleAIFeatureVisibility();
    //     console.log('Premium status toggled to:', isUserPremium);
    // });
    // if (document.body) {
    //     document.body.appendChild(tempPremiumToggleButton);
    // }


</script>
  </body>
</html>
